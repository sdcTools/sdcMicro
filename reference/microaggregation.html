<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Microaggregation — microaggregation • sdcMicro</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Microaggregation — microaggregation"><meta property="og:description" content="Function to perform various methods of microaggregation."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sdcMicro</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">5.7.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/sdcMicro.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/recordSwapping.html">Targeted Record Swapping</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/sdcTools/sdcMicro/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Microaggregation</h1>
    <small class="dont-index">Source: <a href="https://github.com/sdcTools/sdcMicro/blob/HEAD/R/microaggregation.R" class="external-link"><code>R/microaggregation.R</code></a></small>
    <div class="hidden name"><code>microaggregation.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function to perform various methods of microaggregation.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">microaggregation</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  variables <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  aggr <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  strata_variables <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"mdav"</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nc <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  clustermethod <span class="op">=</span> <span class="st">"clara"</span>,</span>
<span>  measure <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  trim <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  varsort <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  transf <span class="op">=</span> <span class="st">"log"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>obj</dt>
<dd><p>either an object of class <code><a href="sdcMicroObj-class.html">sdcMicroObj-class</a></code> or a <code>data.frame</code></p></dd>


<dt>variables</dt>
<dd><p>variables to microaggregate. For <code>NULL</code>: If obj is of class
sdcMicroObj, all numerical key variables are chosen per default. For
<code>data.frames</code>, all columns are chosen per default.</p></dd>


<dt>aggr</dt>
<dd><p>aggregation level (default=3)</p></dd>


<dt>strata_variables</dt>
<dd><p>for <code>data.frames</code>, by-variables for applying microaggregation only
within strata defined by the variables. For <code><a href="sdcMicroObj-class.html">sdcMicroObj-class</a></code>-objects, the
stratification-variable defined in slot <code>@strataVar</code> is used. This slot can be changed any
time using <code>strataVar&lt;-</code>.</p></dd>


<dt>method</dt>
<dd><p>pca, rmd, onedims, single, simple, clustpca, pppca,
clustpppca, mdav, clustmcdpca, influence, mcdpca</p></dd>


<dt>weights</dt>
<dd><p>sampling weights. If obj is of class sdcMicroObj the vector
of sampling weights is chosen automatically. If determined, a weighted
version of the aggregation measure is chosen automatically, e.g. weighted
median or weighted mean.</p></dd>


<dt>nc</dt>
<dd><p>number of cluster, if the chosen method performs cluster analysis</p></dd>


<dt>clustermethod</dt>
<dd><p>clustermethod, if necessary</p></dd>


<dt>measure</dt>
<dd><p>aggregation statistic, mean, median, trim, onestep (default=mean)</p></dd>


<dt>trim</dt>
<dd><p>trimming percentage, if measure=trim</p></dd>


<dt>varsort</dt>
<dd><p>variable for sorting, if method=single</p></dd>


<dt>transf</dt>
<dd><p>transformation for data x</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>If ‘obj’ was of class <code><a href="sdcMicroObj-class.html">sdcMicroObj-class</a></code> the corresponding
slots are filled, like manipNumVars, risk and utility. If ‘obj’ was
of class “data.frame”, an object of class “micro” with following entities is returned:</p><dl><dt><code>x</code>: </dt>
<dd><p>original data</p></dd>

<dt><code>mx</code>: </dt>
<dd><p>the microaggregated dataset</p></dd>

<dt><code>method</code>: </dt>
<dd><p>method</p></dd>

<dt><code>aggr</code>: </dt>
<dd><p>aggregation level</p></dd>

<dt><code>measure</code>: </dt>
<dd><p>proximity measure for aggregation</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>On <a href="https://research.cbs.nl/casc/glossary.htm" class="external-link">https://research.cbs.nl/casc/glossary.htm</a> one can found the
“official” definition of microaggregation:</p>
<p>Records are grouped based on a proximity measure of variables of interest,
and the same small groups of records are used in calculating aggregates for
those variables. The aggregates are released instead of the individual
record values.</p>
<p>The recommended method is “rmd” which forms the proximity using
multivariate distances based on robust methods. It is an extension of the
well-known method “mdav”.  However, when computational speed is
important, method “mdav” is the preferable choice.</p>
<p>While for the proximity measure very different concepts can be used, the
aggregation itself is naturally done with the arithmetic mean.
Nevertheless, other measures of location can be used for aggregation,
especially when the group size for aggregation has been taken higher than 3.
Since the median seems to be unsuitable for microaggregation because of
being highly robust, other mesures which are included can be chosen. If a
complex sample survey is microaggregated, the corresponding sampling weights
should be determined to either aggregate the values by the weighted
arithmetic mean or the weighted median.</p>
<p>This function contains also a method with which the data can be clustered
with a variety of different clustering algorithms. Clustering observations
before applying microaggregation might be useful.  Note, that the data are
automatically standardised before clustering.</p>
<p>The usage of clustering method ‘Mclust’ requires package mclust02,
which must be loaded first. The package is not loaded automatically, since
the package is not under GPL but comes with a different licence.</p>
<p>The are also some projection methods for microaggregation included.  The
robust version ‘pppca’ or ‘clustpppca’ (clustering at first)
are fast implementations and provide almost everytime the best results.</p>
<p>Univariate statistics are preserved best with the individual ranking method
(we called them ‘onedims’, however, often this method is named
‘individual ranking’), but multivariate statistics are strong
affected.</p>
<p>With method ‘simple’ one can apply microaggregation directly on the
(unsorted) data. It is useful for the comparison with other methods as a
benchmark, i.e. replies the question how much better is a sorting of the
data before aggregation.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>if only one variable is specified, <code><a href="mafast.html">mafast</a></code> is applied and argument <code>method</code> is ignored.
Parameters <code>measure</code> are ignored for methods <code>mdav</code> and <code>rmd</code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Templ, M. and Meindl, B., <em>Robust Statistics Meets SDC: New Disclosure
Risk Measures for Continuous Microdata Masking</em>, Lecture Notes in Computer
Science, Privacy in Statistical Databases, vol. 5262, pp. 113-126, 2008.</p>
<p>Templ, M. <em>Statistical Disclosure Control for Microdata Using the
R-Package sdcMicro</em>, Transactions on Data Privacy, vol. 1, number 2, pp.
67-85, 2008.  <a href="http://www.tdp.cat/issues/abs.a004a08.php" class="external-link">http://www.tdp.cat/issues/abs.a004a08.php</a></p>
<p>Templ, M. <em>New Developments in Statistical Disclosure Control and
Imputation: Robust Statistics Applied to Official Statistics</em>,
Suedwestdeutscher Verlag fuer Hochschulschriften, 2009, ISBN: 3838108280,
264 pages.</p>
<p>Templ, M. Statistical Disclosure Control for Microdata: Methods and Applications in R.
<em>Springer International Publishing</em>, 287 pages, 2017. ISBN 978-3-319-50272-4. <a href="https://doi.org/10.1007/978-3-319-50272-4" class="external-link">doi:10.1007/978-3-319-50272-4</a>

<a href="https://doi.org/10.1007/978-3-319-50272-4" class="external-link">doi:10.1007/978-3-319-50272-4</a></p>
<p>Templ, M. and Meindl, B. and Kowarik, A.: <em>Statistical Disclosure Control for
Micro-Data Using the R Package sdcMicro</em>, Journal of Statistical Software,
67 (4), 1--36, 2015.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="summary.micro.html">summary.micro</a></code>, <code><a href="plotMicro.html">plotMicro</a></code>,
<code><a href="valTable.html">valTable</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Matthias Templ, Bernhard Meindl</p>
<p>For method “mdav”: This work is being supported by the International
Household Survey Network (IHSN) and funded by a DGF Grant provided by the
World Bank to the PARIS21 Secretariat at the Organisation for Economic
Co-operation and Development (OECD).  This work builds on previous work
which is elsewhere acknowledged.</p>
<p>Author for the integration of the code for mdav in R: Alexander Kowarik.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># dontrun since Examples with CPU time larger 2.5 times elapsed time, because</span></span></span>
<span class="r-in"><span><span class="co"># of using data.table and multicore computation.</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">microaggregation</span><span class="op">(</span></span></span>
<span class="r-in"><span>  obj <span class="op">=</span> <span class="va">testdata</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"expend"</span>, <span class="st">"income"</span>, <span class="st">"savings"</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"mdav"</span>,</span></span>
<span class="r-in"><span>  aggr <span class="op">=</span> <span class="fl">4</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## for objects of class sdcMicro:</span></span></span>
<span class="r-in"><span><span class="co">## no stratification because `@strataVar` is `NULL`</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">testdata2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sdc</span> <span class="op">&lt;-</span> <span class="fu"><a href="sdcMicroObj-class.html">createSdcObj</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  dat <span class="op">=</span> <span class="va">testdata2</span>,</span></span>
<span class="r-in"><span>  keyVars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"urbrur"</span>, <span class="st">"roof"</span>, <span class="st">"walls"</span>, <span class="st">"water"</span>, <span class="st">"electcon"</span>, <span class="st">"sex"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  numVars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"expend"</span>, <span class="st">"income"</span>, <span class="st">"savings"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  w <span class="op">=</span> <span class="st">"sampling_weight"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sdc</span> <span class="op">&lt;-</span> <span class="fu">microaggregation</span><span class="op">(</span></span></span>
<span class="r-in"><span>  obj <span class="op">=</span> <span class="va">sdc</span>,</span></span>
<span class="r-in"><span>  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"expend"</span>, <span class="st">"income"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## with stratification using variable `"relat"`</span></span></span>
<span class="r-in"><span><span class="fu">strataVar</span><span class="op">(</span><span class="va">sdc</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"relat"</span></span></span>
<span class="r-in"><span><span class="va">sdc</span> <span class="op">&lt;-</span> <span class="fu">microaggregation</span><span class="op">(</span></span></span>
<span class="r-in"><span>  obj <span class="op">=</span> <span class="va">sdc</span>,</span></span>
<span class="r-in"><span>  variables <span class="op">=</span> <span class="st">"savings"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Matthias Templ, Bernhard Meindl, Alexander Kowarik, Johannes Gussenbauer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

